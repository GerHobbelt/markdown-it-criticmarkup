{"version":3,"file":"markdownItCriticmarkup.umd.js","sources":["../index.js"],"sourcesContent":["/**\n * critic markup                HTML                    LaTeX\n    {--[text]--}            <del>[text]</del>                     \\st{[text]}\n    {++[text]++}            <ins>[text]</ins>                     \\underline{[text]}\n    {~~[text1]~>[text2]~~}  <del>[text1]</del><ins>[text2]</ins>  \\st{[text1]}\\underline{[text2]}\n    {==[text]==}            <mark>[text]</mark>                   \\hl{[text]}\n    {>>[text]<<}            <aside>[text]</aside>                 \\marginpar{[text]}\n  */\n\n\n\n\n\n\n/**\n * CriticMarkup rule\n */\nexport default function critcmarkup_plugin(md) {\n  md.inline.ruler.before('strikethrough', 'critic-markup', (state, silent) => {\n    const src = state.src,\n          pos = state.pos;\n    if (src[pos] === '{' && (\n      (src[pos + 1] === '-' && src[pos + 2] === '-') ||\n        (src[pos + 1] === '+' && src[pos + 2] === '+') ||\n        (src[pos + 1] === '~' && src[pos + 2] === '~') ||\n        (src[pos + 1] === '=' && src[pos + 2] === '=') ||\n        (src[pos + 1] === '>' && src[pos + 2] === '>')\n    )) {\n      const tag = src.slice(pos + 1, pos + 3);\n      let closeTag = tag;\n      if (closeTag[0] === '>') {\n        closeTag = '<<}';\n      } else {\n        closeTag += '}';\n      }\n\n      let i = pos + 3,\n          end = -1,\n          content = null;\n\n      while (i < src.length) {\n        if (src.startsWith(closeTag, i)) {\n          end = i;\n          break;\n        }\n\n        i += 1;\n      }\n\n      if (end >= 0) {\n        content = src.slice(pos + 3, end);\n      } else {\n        return false;\n      }\n\n      if (content && !silent) {\n        const token = state.push('critic-markup');\n        token.content = content;\n        token.tag = tag;\n\n        state.pos = end + closeTag.length;\n        return true;\n      }\n      return false;\n    }\n    return false;\n  });\n\n  /**\n   * CriticMarkup renderer\n   */\n  md.renderer.rules['critic-markup'] = (tokens, idx) => {\n    const token = tokens[idx],\n          tag = token.tag,\n          content = token.content;\n\n    if (tag === '--') {\n      return `<del>${content}</del>`;\n    } else if (tag === '++') {\n      return `<ins>${content}</ins>`;\n    } else if (tag === '==') {\n      return `<mark>${content}</mark>`;\n    } else if (tag === '>>') {\n      return `<aside>${content}</aside>`;\n    }  // {~~[text1]~>[text2]~~}\n    const arr = content.split('~>');\n    if (arr.length === 2) {\n      return `<del>${arr[0]}</del><ins>${arr[1]}</ins>`;\n    }\n    throw new Error(`Error: '~>' not found in critic markup chunk {~~${content}--}`);\n  };\n}\n"],"names":["critcmarkup_plugin","md","inline","ruler","before","state","silent","src","pos","tag","slice","closeTag","i","end","content","length","startsWith","token","push","renderer","rules","tokens","idx","arr","split","Error"],"mappings":"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"}